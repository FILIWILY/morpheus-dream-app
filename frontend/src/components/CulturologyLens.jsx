import React from 'react';
import styles from './CulturologyLens.module.css';
import ReactMarkdown from 'react-markdown';

const mockCulturologyData = {
    preface: {
        title: 'Макро-анализ Сновидения',
        content: `Ваш сон представляет собой классический сценарий для современного европейца, чья жизнь тесно связана с профессиональной деятельностью: это **моделирование тревоги по поводу рисков и поиск новой парадигмы успеха**. Ваше подсознание не просто показывает страхи, оно активно тестирует стратегии. Для этого оно использует как универсальные архетипы (путешествие, дорогостоящая ошибка), так и ультрасовременные символы власти и компетенции (киберспортсмен-чемпион). **Экспертный вывод таков:** этот сон — не предсказание, а внутренняя "штабная игра", цель которой — найти баланс между контролем и инновациями в важном для вас проекте.`
    },
    analysis: [
        {
            title: 'Архетип: Дорогостоящая Ошибка',
            content: `Этот образ, воплощенный в абсурдной покупке воды на 19 тысяч рублей, является мощным символом тревоги. **Сонник Миллера** часто связывает денежные потери во сне с реальными деловыми неудачами. Однако **Зигмунд Фрейд** увидел бы здесь страх потери контроля или "потенции" в широком смысле — боязнь оказаться несостоятельным перед лицом ответственности. Интересно, что научные исследования снов (сомнология) показывают, что **сны о финансовых операциях и нелепых тратах часто снятся людям в периоды карьерной неопределенности** или перед принятием важных решений. Ваше подсознание берет эту общую тревогу и доводит ее до абсурда, чтобы показать иррациональность страха, ведь в итоге ситуация разрешилась без вашего прямого участия.`
        },
        {
            title: 'Архетип: Неожиданный Мудрец',
            content: `Появление киберспортсмена из команды Team Spirit — это блестящий пример того, как подсознание адаптирует классические архетипы под современность. На смену "мудрому старцу" из сказок приходит "мудрый игрок". **Карл Юнг** назвал бы такую фигуру тенью вашего собственного потенциала — той части вас, которая обладает желаемыми качествами. В современной культуре чемпион в киберспорте — это не просто игрок, а **символ стратегического мышления, быстрой реакции и идеальной командной работы**. Ваш разговор с ним — это внутренний запрос на эти качества. Вы ищете не просто совет, а новую, более гибкую и эффективную модель поведения для достижения победы.`
        }
    ],
    insight: {
        title: 'Ключевой Инсайт и Практический Совет',
        content: `Ваш сон высвечивает внутренний конфликт между стремлением к тотальному контролю (страх ошибки) и потребностью в более гибких, современных стратегиях. Вы боитесь рисковать, но понимаете, что старые методы не всегда ведут к победе на "новой карте".`,
        recommendation: `**Прикладной совет:**
Попробуйте применить "стратегию геймера" к одной из ваших реальных рабочих задач. Разбейте ее на три этапа:
1.  **"Разведка":** Потратьте немного времени на анализ новых подходов или технологий в вашей сфере.
2.  **"Тренировка в песочнице":** Создайте небольшой, низкорисковый экспериментальный проект, где вы можете опробовать эти новые подходы, не боясь "проиграть 19 тысяч".
3.  **"Рейд":** Если эксперимент удался, примените полученный опыт к основной, важной задаче.
Этот подход позволит вам внедрять инновации, при этом сохраняя чувство контроля, которого так ищет ваше подсознание.`
    }
};


const CulturologyLens = ({ data, accentColor }) => {
    // Используем данные из пропсов или моковые данные, если пропсы неполные
    const { preface, analysis, insight } = (data && data.preface && data.analysis && data.insight) ? data : mockCulturologyData;

    if (!preface || !analysis || !insight) {
        return <div className={styles.container}><p>Данные для культурологического анализа не доступны.</p></div>;
    }

    return (
        <div className={styles.container} style={{ ['--lens-accent-color']: accentColor }}>
            {preface && (
                <section>
                    <h3 className={styles.mainTitle}>{preface.title}</h3>
                    <div className={styles.markdown}>
                        <ReactMarkdown>{preface.content}</ReactMarkdown>
                    </div>
                </section>
            )}

            {analysis && Array.isArray(analysis) && analysis.length > 0 && (
                 <section>
                    <h3 className={styles.mainTitle}>Глубинный Анализ Ключевых Образов</h3>
                    <div className={styles.analysisGrid}>
                        {analysis.map((item, index) => (
                            <div key={index} className={styles.archetypeCard}>
                                <h4 className={styles.archetypeTitle}>{item.title}</h4>
                                <div className={styles.markdown}>
                                    <ReactMarkdown>{item.content}</ReactMarkdown>
                                </div>
                            </div>
                        ))}
                    </div>
                 </section>
            )}

            {insight && (
                 <section>
                    <h3 className={styles.mainTitle}>{insight.title}</h3>
                    <div className={styles.markdown}>
                        <ReactMarkdown>{insight.content}</ReactMarkdown>
                    </div>
                    <div className={`${styles.recommendationBox} ${styles.markdown}`}>
                         <ReactMarkdown>{insight.recommendation}</ReactMarkdown>
                    </div>
                </section>
            )}
        </div>
    );
};

export default CulturologyLens;
